<!DOCTYPE html> <html lang="en"> <head> <meta charset="utf-8"/> <meta http-equiv="X-UA-Compatible" content="IE=edge"/> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> <meta name="viewport" content="width=device-width, initial-scale=1"/> <meta name="flattr:id" content="e7nqg5"/> <title>Linear Advance | Marlin Firmware</title> <meta name="generator" content="Jekyll v3.9.0"/> <meta property="og:title" content="Linear Advance"/> <meta name="author" content="Sebastianv650, Sineos"/> <meta property="og:locale" content="en_US"/> <meta name="description" content="Nozzle pressure control to improve print quality"/> <meta property="og:description" content="Nozzle pressure control to improve print quality"/> <link rel="canonical" href="https://marlinfw.org/docs/features/lin_advance.html"/> <meta property="og:url" content="https://marlinfw.org/docs/features/lin_advance.html"/> <meta property="og:site_name" content="Marlin Firmware"/> <meta property="og:type" content="article"/> <meta property="article:published_time" content="2024-02-07T22:52:35-06:00"/> <meta name="twitter:card" content="summary"/> <meta property="twitter:title" content="Linear Advance"/> <meta name="twitter:site" content="@MarlinFirmware"/> <meta name="twitter:creator" content="@Sebastianv650, Sineos"/> <script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"Sebastianv650, Sineos"},"dateModified":"2024-02-07T22:52:35-06:00","datePublished":"2024-02-07T22:52:35-06:00","description":"Nozzle pressure control to improve print quality","headline":"Linear Advance","mainEntityOfPage":{"@type":"WebPage","@id":"https://marlinfw.org/docs/features/lin_advance.html"},"publisher":{"@type":"Organization","logo":{"@type":"ImageObject","url":"https://marlinfw.org/assets/images/logo/marlin/small.png"},"name":"Sebastianv650, Sineos"},"url":"https://marlinfw.org/docs/features/lin_advance.html"}</script> <link rel="icon" href="/assets/favicon_m.ico"/> <link rel="stylesheet" href="/assets/stylesheets/main.css"/> <!--[if lt IE 9]><script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script> <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script><![endif]--> <script src="/assets/javascript/head.min.js"></script> <script type="text/javascript">

      /**
       * As Github pages do not support https for custom domains
       * this is the current best workaround for #18.
       */
      var domains  = [ 'marlinfw.org', 'localhost', '127.0.0.1' ];
      var pathname = location.pathname.replace(/^\/MarlinDocumentation/, '')
      if (domains.indexOf(window.location.hostname) == -1)
        window.top.location.href = 'https://marlinfw.org' + pathname;

      /**
       * Another ugly workaround trying to improve UX reported by #35
       */
      if (location.protocol != 'https:' && window.location.hostname == 'marlinfw.org')
        location.href = 'https:' + window.location.href.substring(window.location.protocol.length);

      /**
       * Improves overall speed by loading javascript and css resources in parallel
       * with the main page.
       */
      head.load(
          "/assets/stylesheets/fontawesome.min.css",
          "/assets/stylesheets/solid.min.css",
          "/assets/stylesheets/brands.min.css",

          "/assets/javascript/jquery-2.2.1.min.js",
          "/assets/javascript/jquery-ui.min.js",
          "/assets/javascript/bootstrap.min.js",
          "/assets/javascript/tocify.min.js",
          "/assets/javascript/search.js",
          "/assets/javascript/custom.js",

          "/assets/javascript/sheetrock.min.js",
          "/assets/javascript/cookieconsent.min.js"
      );

      head.ready(function() {
        window.cookieconsent_options = {
          "message":"We use cookies to ensure you get the best experience on our website",
          "dismiss": "Got it!", "learnMore": "More info", "link":"", "theme": "dark-bottom"
        };
      });
    </script> </head> <body role="document"> <nav class="navbar navbar-default navbar-fixed-top custom-no-margin"> <div class="container"> <div class="navbar-header"> <img id="daynite" src="/assets/images/btn-night.svg" alt="Dark Mode" width="32" height="32"> <a href="/" class="navbar-brand"> <svg id="mflogo" height="95%" version="1.1" viewbox="0 0 828.26325 270.80054"> <g id="g981"> <path d="M 69.48788,0 C 31.1751,0 0,32.61059 0,72.74045 V 198.055 c 0,40.12987 31.17607,72.74553 69.48788,72.74553 H 758.7735 c 38.3127,0 69.4898,-32.61566 69.4898,-72.74553 V 5.84382 c -0.019,-3.60102 -2,-5.68155 -6.9765,-5.84159 H 220.29327 Z m 0,21.01625 H 682.6259 c 8.157,0.43104 14.4593,1.90061 18.9474,6.50681 7.8555,8.06197 84.9293,82.07514 102.73,100.35813 1.8839,1.93509 3.8964,6.37495 3.8964,11.50813 v 58.66132 c 0,28.84892 -21.8776,51.7242 -49.4209,51.7242 H 69.4932 c -27.54239,0 -49.42089,-22.87528 -49.42089,-51.7242 V 72.73609 c 0,-0.90162 0.0193,-1.79645 0.0619,-2.6858 1.30928,-27.57002 22.67685,-49.0386 49.35799,-49.0386 z" fill="#0000ff" id="path957" style="fill-opacity:1;stroke:none;stroke-width:0.999984" class="logo"></path> <path d="m 539.5917,36.40978 -0.068,135.74053 c 0,17.73633 5.7753,32.12681 17.3285,43.16739 11.7332,11.22111 26.2205,18.88542 44.6327,18.88542 1.6257,0 4.7893,-0.14503 4.7893,-0.14503 v -30.53858 c -1.4629,0.1785 -2.9571,-0.0101 -4.5172,-0.0101 -9.3867,0 -16.3858,-3.57688 -22.162,-9.36867 -5.7765,-5.79149 -8.6669,-13.38947 -8.6617,-22.80124 l 0.068,-134.92917 z" fill="#0000ff" id="path965" style="fill-opacity:1;stroke:none;stroke-width:0.999984" class="logo"></path> <path d="m 48.89544,88.53966 c 0,-15.02233 5.05444,-27.69172 15.1637,-38.00816 10.10849,-10.31644 22.56459,-15.47466 37.36638,-15.47466 6.85957,0 12.81609,0.99594 17.8713,2.98631 5.23501,1.6288 9.65764,3.80061 13.268,6.51552 3.24931,1.99088 6.40833,4.52476 9.47717,7.60143 l 5.957,5.70143 c 1.26361,-1.62891 2.34665,-2.89595 3.24921,-3.80092 1.08314,-1.086 2.07599,-1.99087 2.97855,-2.71481 1.62466,-1.6289 5.77653,-4.70578 12.45611,-9.23064 6.67909,-4.70548 15.8856,-7.05832 27.61884,-7.05832 14.44084,0 26.89694,5.15812 37.36638,15.47466 10.4704,10.31644 15.70464,22.98583 15.70464,38.00816 V 234.05708 H 212.17203 V 90.71005 c 0,-6.3347 -2.52722,-11.94525 -7.58166,-16.83268 -4.87396,-4.88662 -10.6504,-7.32972 -17.32939,-7.32972 -6.49862,0 -11.9142,2.26207 -16.24655,6.78662 -4.33235,4.34371 -6.49852,10.13551 -6.49852,17.37527 V 234.05657 H 129.58617 V 90.70954 c 0,-5.97283 -2.16617,-11.49291 -6.49862,-16.56087 -4.33235,-5.06765 -9.47707,-7.60143 -15.43369,-7.60143 -5.95661,0 -11.46325,2.53378 -16.5175,7.60143 -4.69339,5.06735 -7.04013,10.58825 -7.04013,16.56087 V 234.05657 H 56.2045 c -4.86419,0 -7.30897,-2.56065 -7.30897,-7.68216 z" fill="#0000ff" id="path971" style="fill-opacity:1;stroke:none;stroke-width:0.999984" class="logo"></path> <path d="m 325.92573,233.97594 c -14.76501,0.48682 -35.97484,-4.07232 -49.33284,-17.10347 -13.35799,-13.21198 -20.03699,-29.59131 -20.03699,-49.13799 0,-19.90874 6.85957,-36.74041 20.5789,-50.49499 13.71933,-13.75458 30.5074,-20.63288 50.36439,-20.63288 19.857,0 36.19355,6.87749 49.00963,20.63288 12.81706,13.75458 19.2251,31.67347 19.2251,53.75362 v 62.98384 h -31.68024 v -61.89764 c 0,-13.39352 -3.42988,-24.07203 -10.28944,-32.03452 -6.85967,-8.14463 -15.9756,-12.21705 -27.34789,-12.21705 -10.28945,0 -19.1351,3.80082 -26.536,11.40265 -7.40118,7.60153 -11.10134,16.55986 -11.10134,26.8763 0,11.04058 3.88112,20.36108 11.64325,27.96251 7.9427,7.60143 19.68959,9.79078 29.32391,9.40397 h 21.93269 v 30.53857 z" fill="#0000ff" id="path969" style="fill-opacity:1;stroke:none;stroke-width:0.999984" class="logo"></path> <path d="m 467.4988,98.58024 c -18.4123,0 -33.485,5.60873 -45.2182,16.82963 -11.5533,11.04059 -17.32847,25.43006 -17.32847,43.16639 v 75.47169 h 31.40927 v -74.65831 c 0,-9.41137 2.8852,-17.01117 8.6617,-22.80327 5.7765,-5.79179 13.3609,-8.68875 22.7475,-8.68875 9.0258,0 16.4265,2.98682 22.2036,8.95975 5.9571,5.97231 8.934,13.48176 8.934,22.53146 l -0.1529,1.81451 h 31.4092 l 0.1529,-2.62779 c 1.04,-17.88441 -5.8668,-32.39761 -17.6003,-43.43718 -11.7332,-11.04058 -26.806,-16.55884 -45.2182,-16.55884 z" fill="#0000ff" id="path967" style="fill-opacity:1;stroke:none;stroke-width:0.999984" class="logo"></path> <path d="m 656.9725,158.62088 c 0,-17.73633 5.7765,-32.1258 17.3294,-43.16537 11.7332,-11.22111 26.8069,-16.83166 45.2192,-16.83166 18.4122,0 33.4859,5.52009 45.2191,16.55986 11.7333,11.04058 17.6004,25.5193 17.6004,43.43717 v 67.58629 c -0.039,5.32475 -2.4795,7.8854 -7.4874,7.8854 h -23.9223 v -74.65729 c 0,-9.0493 -2.9785,-16.55986 -8.9355,-22.53248 -5.7766,-5.97262 -13.178,-8.95893 -22.2037,-8.95893 -9.3869,0 -16.9684,2.89564 -22.7446,8.68723 -5.7765,5.79179 -8.6648,13.39352 -8.6648,22.80428 v 74.65729 h -31.4092 z" fill="#0000ff" id="path959" style="fill-opacity:1;stroke:none;stroke-width:0.999984" class="logo"></path> <path d="m 616.136,92.69788 h 31.6802 l 10e-5,-15.49698 v -4.28763 c 0,-8.585 -6.4197,-15.49596 -14.3934,-15.49596 h -2.8932 c -7.9741,0 -14.3934,6.91137 -14.3934,15.49596 v 4.28763 z" color="#000000" color-rendering="auto" enable-background="accumulate" fill="#0000ff" fill-rule="evenodd" image-rendering="auto" shape-rendering="auto" solid-color="#000000" style="fill-opacity:1;stroke:none;stroke-width:0.999984" id="path961" class="logo"></path> <path d="m 616.136,100.71006 h 31.6802 V 234.00637 H 616.136 Z" color="#000000" color-rendering="auto" enable-background="accumulate" fill="#0000ff" fill-rule="evenodd" image-rendering="auto" shape-rendering="auto" solid-color="#000000" style="fill-opacity:1;stroke:none;stroke-width:0.999984" id="path963" class="logo"></path> </g> </svg> </a> <button class="navbar-toggle" type="button" data-toggle="collapse" data-target="#navbar-main"> <span class="icon-bar"></span> <span class="icon-bar"></span> <span class="icon-bar"></span> </button> </div> <div class="navbar-collapse collapse" id="navbar-main"> <ul class="nav navbar-nav"> <li id="top-intro"><a href="/docs/basics/introduction.html">About Marlin</a></li> <li id="top-download"><a href="/meta/download/">Download</a></li> <li id="top-config"><a href="/docs/configuration/configuration.html">Configure</a></li> <li id="top-install"><a href="/docs/basics/install.html">Install</a></li> <li id="top-tools" class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-tools">Tools <span class="caret"></span></a> <ul class="dropdown-menu"> <li><a href="/tools/u8glib/converter.html">Bitmap Converter</a></li> <li><a href="/tools/rgb565/converter.html">RGB565 Converter</a></li> <li><a href="/tools/lin_advance/k-factor.html">Calibrate Linear Advance</a></li> <li><a href="/tools/input_shaping/freq-calibr.html">Calibrate Input Shaping</a></li> <li class="divider"> <li><a href="//github.com/MarlinFirmware/Marlin/issues">Bugtracker</a></li> <li><a href="/docs/basics/reporting_bugs.html">Reporting bugs</a></li> <li class="divider"> <li><a href="//github.com/MarlinFirmware/Marlin">Source Code Repository</a></li> </ul> </li> <li id="top-help" class="dropdown"> <a class="dropdown-toggle" data-toggle="dropdown" href="#" id="navbar-documentation">Help <span class="caret"></span></a> <ul class="dropdown-menu"> <li class="dropdown-submenu configuration"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Configuration</a> <ul class="dropdown-menu"> <li><a href="/meta/configuration/">All documents</a></li> <li class="divider"> <li><a href="/docs/configuration/1.1/laser_spindle.html">Laser/Spindle Configuration (1.1.x)</a></li> <li><a href="/docs/configuration/2.0.9/laser_spindle.html">Laser/Spindle Configuration (2.0.9.x)</a></li> <li><a href="/docs/configuration/config-ini.html">Configuring with INI</a></li> <li><a href="/docs/configuration/configuration.html">Configuring Marlin</a></li> <li><a href="/docs/configuration/probes.html">Probe Configuration</a></li> </ul> </li> <li class="dropdown-submenu development"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Development</a> <ul class="dropdown-menu"> <li><a href="/meta/development/">All documents</a></li> <li class="divider"> <li><a href="/docs/development/boards.html">Boards</a></li> <li class="divider"> <li><a href="/docs/development/code_structure.html">Code Structure</a></li> <li><a href="/docs/development/coding_standards.html">Coding Standards</a></li> <li><a href="/docs/development/fastio.html">FastIO</a></li> <li><a href="/docs/development/hal.html">Hardware Abstraction Layer</a></li> <li class="divider"> <li><a href="/docs/development/contributing.html">Contributing to Marlin</a></li> <li class="divider"> <li><a href="/docs/development/feature_request.html">Feature requests</a></li> <li><a href="/docs/development/getting_started_pull_requests.html">Contributing Code with Pull Requests</a></li> <li><a href="/docs/development/git_scripts.html">Marlin Github Scripts</a></li> <li class="divider"> <li><a href="/docs/development/fonts.html">Adding new fonts</a></li> <li><a href="/docs/development/lcd_language.html">LCD Language System</a></li> </ul> </li> <li class="dropdown-submenu features"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Features</a> <ul class="dropdown-menu"> <li><a href="/meta/features/">All documents</a></li> <li class="divider"> <li><a href="/docs/features/auto_bed_leveling.html">Automatic Bed Leveling</a></li> <li><a href="/docs/features/unified_bed_leveling.html">Unified Bed Leveling</a></li> <li class="divider"> <li><a href="/docs/features/autostart.html">Autostart</a></li> <li class="divider"> <li><a href="/docs/features/eeprom.html">EEPROM</a></li> <li class="divider"> <li><a href="/docs/features/fwretract.html">Firmware Retract</a></li> <li><a href="/docs/features/input_shaping.html">Input Shaping</a></li> <li><a href="/docs/features/lin_advance.html">Linear Advance</a></li> <li><a href="/docs/features/model_predictive_control.html">Model Predictive Temperature Control</a></li> <li><a href="/docs/features/probe_temp_compensation.html">Probe Temperature Compensation</a></li> <li class="divider"> <li><a href="/docs/features/lcd_menu.html">LCD Menu Tree</a></li> </ul> </li> <li class="dropdown-submenu gcode"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">G-code</a> <ul class="dropdown-menu"> <li><a href="/meta/gcode/">All documents</a></li> <li class="divider"> <li><a href="/docs/gcode/G000-G001.html"><strong>G0-G1</strong>: Linear Move</a></li> <li><a href="/docs/gcode/G002-G003.html"><strong>G2-G3</strong>: Arc or Circle Move</a></li> <li><a href="/docs/gcode/G004.html"><strong>G4</strong>: Dwell</a></li> <li><a href="/docs/gcode/G005.html"><strong>G5</strong>: Bézier cubic spline</a></li> <li><a href="/docs/gcode/G006.html"><strong>G6</strong>: Direct Stepper Move</a></li> <li><a href="/docs/gcode/G010.html"><strong>G10</strong>: Retract</a></li> <li><a href="/docs/gcode/G011.html"><strong>G11</strong>: Recover</a></li> <li><a href="/docs/gcode/G012.html"><strong>G12</strong>: Clean the Nozzle</a></li> <li><a href="/docs/gcode/G017-G019.html"><strong>G17-G19</strong>: CNC Workspace Planes</a></li> <li><a href="/docs/gcode/G020.html"><strong>G20</strong>: Inch Units</a></li> <li><a href="/docs/gcode/G021.html"><strong>G21</strong>: Millimeter Units</a></li> <li><a href="/docs/gcode/G026.html"><strong>G26</strong>: Mesh Validation Pattern</a></li> <li><a href="/docs/gcode/G027.html"><strong>G27</strong>: Park toolhead</a></li> <li><a href="/docs/gcode/G028.html"><strong>G28</strong>: Auto Home</a></li> <li><a href="/docs/gcode/G029.html"><strong>G29</strong>: Bed Leveling</a></li> <li><a href="/docs/gcode/G029-abl-3point.html"><strong>G29</strong>: Bed Leveling (3-Point)</a></li> <li><a href="/docs/gcode/G029-abl-linear.html"><strong>G29</strong>: Bed Leveling (Linear)</a></li> <li><a href="/docs/gcode/G029-mbl.html"><strong>G29</strong>: Bed Leveling (Manual)</a></li> <li><a href="/docs/gcode/G029-abl-bilinear.html"><strong>G29</strong>: Bed Leveling (Bilinear)</a></li> <li><a href="/docs/gcode/G029-ubl.html"><strong>G29</strong>: Bed Leveling (Unified)</a></li> <li><a href="/docs/gcode/G030.html"><strong>G30</strong>: Single Z-Probe</a></li> <li><a href="/docs/gcode/G031.html"><strong>G31</strong>: Dock Sled</a></li> <li><a href="/docs/gcode/G032.html"><strong>G32</strong>: Undock Sled</a></li> <li><a href="/docs/gcode/G033.html"><strong>G33</strong>: Delta Auto Calibration</a></li> <li><a href="/docs/gcode/G034-zsaa.html"><strong>G34</strong>: Z Steppers Auto-Alignment</a></li> <li><a href="/docs/gcode/G034-mgc.html"><strong>G34</strong>: Mechanical Gantry Calibration</a></li> <li><a href="/docs/gcode/G035.html"><strong>G35</strong>: Tramming Assistant</a></li> <li><a href="/docs/gcode/G038.html"><strong>G38.2-G38.5</strong>: Probe target</a></li> <li><a href="/docs/gcode/G042.html"><strong>G42</strong>: Move to mesh coordinate</a></li> <li><a href="/docs/gcode/G053.html"><strong>G53</strong>: Move in Machine Coordinates</a></li> <li><a href="/docs/gcode/G054-G059.html"><strong>G54-G59.3</strong>: Workspace Coordinate System</a></li> <li><a href="/docs/gcode/G060.html"><strong>G60</strong>: Save Current Position</a></li> <li><a href="/docs/gcode/G061.html"><strong>G61</strong>: Return to Saved Position</a></li> <li><a href="/docs/gcode/G076.html"><strong>G76</strong>: Probe temperature calibration</a></li> <li><a href="/docs/gcode/G080.html"><strong>G80</strong>: Cancel Current Motion Mode</a></li> <li><a href="/docs/gcode/G090.html"><strong>G90</strong>: Absolute Positioning</a></li> <li><a href="/docs/gcode/G091.html"><strong>G91</strong>: Relative Positioning</a></li> <li><a href="/docs/gcode/G092.html"><strong>G92</strong>: Set Position</a></li> <li><a href="/docs/gcode/G425.html"><strong>G425</strong>: Backlash Calibration</a></li> <li><a href="/docs/gcode/M000-M001.html"><strong>M0-M1</strong>: Unconditional stop</a></li> <li><a href="/docs/gcode/M003.html"><strong>M3</strong>: Spindle CW / Laser On</a></li> <li><a href="/docs/gcode/M004.html"><strong>M4</strong>: Spindle CCW / Laser On</a></li> <li><a href="/docs/gcode/M005.html"><strong>M5</strong>: Spindle / Laser Off</a></li> <li><a href="/docs/gcode/M007-M009.html"><strong>M7-M9</strong>: Coolant Controls</a></li> <li><a href="/docs/gcode/M010-M011.html"><strong>M10-M11</strong>: Vacuum / Blower Control</a></li> <li><a href="/docs/gcode/M016.html"><strong>M16</strong>: Expected Printer Check</a></li> <li><a href="/docs/gcode/M017.html"><strong>M17</strong>: Enable Steppers</a></li> <li><a href="/docs/gcode/M018.html"><strong>M18, M84</strong>: Disable steppers</a></li> <li><a href="/docs/gcode/M020.html"><strong>M20</strong>: List SD Card</a></li> <li><a href="/docs/gcode/M021.html"><strong>M21</strong>: Init SD card</a></li> <li><a href="/docs/gcode/M022.html"><strong>M22</strong>: Release SD card</a></li> <li><a href="/docs/gcode/M023.html"><strong>M23</strong>: Select SD file</a></li> <li><a href="/docs/gcode/M024.html"><strong>M24</strong>: Start or Resume SD print</a></li> <li><a href="/docs/gcode/M025.html"><strong>M25</strong>: Pause SD print</a></li> <li><a href="/docs/gcode/M026.html"><strong>M26</strong>: Set SD position</a></li> <li><a href="/docs/gcode/M027.html"><strong>M27</strong>: Report SD print status</a></li> <li><a href="/docs/gcode/M028.html"><strong>M28</strong>: Start SD write</a></li> <li><a href="/docs/gcode/M029.html"><strong>M29</strong>: Stop SD write</a></li> <li><a href="/docs/gcode/M030.html"><strong>M30</strong>: Delete SD file</a></li> <li><a href="/docs/gcode/M031.html"><strong>M31</strong>: Print time</a></li> <li><a href="/docs/gcode/M032.html"><strong>M32</strong>: Select and Start</a></li> <li><a href="/docs/gcode/M033.html"><strong>M33</strong>: Get Long Path</a></li> <li><a href="/docs/gcode/M034.html"><strong>M34</strong>: SDCard Sorting</a></li> <li><a href="/docs/gcode/M042.html"><strong>M42</strong>: Set Pin State</a></li> <li><a href="/docs/gcode/M043.html"><strong>M43</strong>: Debug Pins</a></li> <li><a href="/docs/gcode/M043-T.html"><strong>M43 T</strong>: Toggle Pins</a></li> <li><a href="/docs/gcode/M048.html"><strong>M48</strong>: Probe Repeatability Test</a></li> <li><a href="/docs/gcode/M073.html"><strong>M73</strong>: Set Print Progress</a></li> <li><a href="/docs/gcode/M075.html"><strong>M75</strong>: Start Print Job Timer</a></li> <li><a href="/docs/gcode/M076.html"><strong>M76</strong>: Pause Print Job Timer</a></li> <li><a href="/docs/gcode/M077.html"><strong>M77</strong>: Stop Print Job Timer</a></li> <li><a href="/docs/gcode/M078.html"><strong>M78</strong>: Print Job Stats</a></li> <li><a href="/docs/gcode/M080.html"><strong>M80</strong>: Power On</a></li> <li><a href="/docs/gcode/M081.html"><strong>M81</strong>: Power Off</a></li> <li><a href="/docs/gcode/M082.html"><strong>M82</strong>: E Absolute</a></li> <li><a href="/docs/gcode/M083.html"><strong>M83</strong>: E Relative</a></li> <li><a href="/docs/gcode/M085.html"><strong>M85</strong>: Inactivity Shutdown</a></li> <li><a href="/docs/gcode/M086.html"><strong>M86</strong>: Hotend Idle Timeout</a></li> <li><a href="/docs/gcode/M087.html"><strong>M87</strong>: Disable Hotend Idle Timeout</a></li> <li><a href="/docs/gcode/M092.html"><strong>M92</strong>: Set Axis Steps-per-unit</a></li> <li><a href="/docs/gcode/M100.html"><strong>M100</strong>: Free Memory</a></li> <li><a href="/docs/gcode/M102.html"><strong>M102</strong>: Configure Bed Distance Sensor</a></li> <li><a href="/docs/gcode/M104.html"><strong>M104</strong>: Set Hotend Temperature</a></li> <li><a href="/docs/gcode/M105.html"><strong>M105</strong>: Report Temperatures</a></li> <li><a href="/docs/gcode/M106.html"><strong>M106</strong>: Set Fan Speed</a></li> <li><a href="/docs/gcode/M107.html"><strong>M107</strong>: Fan Off</a></li> <li><a href="/docs/gcode/M108.html"><strong>M108</strong>: Break and Continue</a></li> <li><a href="/docs/gcode/M109.html"><strong>M109</strong>: Wait for Hotend Temperature</a></li> <li><a href="/docs/gcode/M110.html"><strong>M110</strong>: Set Line Number</a></li> <li><a href="/docs/gcode/M111.html"><strong>M111</strong>: Debug Level</a></li> <li><a href="/docs/gcode/M112.html"><strong>M112</strong>: Full Shutdown</a></li> <li><a href="/docs/gcode/M113.html"><strong>M113</strong>: Host Keepalive</a></li> <li><a href="/docs/gcode/M114.html"><strong>M114</strong>: Get Current Position</a></li> <li><a href="/docs/gcode/M115.html"><strong>M115</strong>: Firmware Info</a></li> <li><a href="/docs/gcode/M117.html"><strong>M117</strong>: Set LCD Message</a></li> <li><a href="/docs/gcode/M118.html"><strong>M118</strong>: Serial print</a></li> <li><a href="/docs/gcode/M119.html"><strong>M119</strong>: Endstop States</a></li> <li><a href="/docs/gcode/M120.html"><strong>M120</strong>: Enable Endstops</a></li> <li><a href="/docs/gcode/M121.html"><strong>M121</strong>: Disable Endstops</a></li> <li><a href="/docs/gcode/M122.html"><strong>M122</strong>: TMC Debugging</a></li> <li><a href="/docs/gcode/M123.html"><strong>M123</strong>: Fan Tachometers</a></li> <li><a href="/docs/gcode/M125.html"><strong>M125</strong>: Park Head</a></li> <li><a href="/docs/gcode/M126.html"><strong>M126</strong>: Baricuda 1 Open</a></li> <li><a href="/docs/gcode/M127.html"><strong>M127</strong>: Baricuda 1 Close</a></li> <li><a href="/docs/gcode/M128.html"><strong>M128</strong>: Baricuda 2 Open</a></li> <li><a href="/docs/gcode/M129.html"><strong>M129</strong>: Baricuda 2 Close</a></li> <li><a href="/docs/gcode/M140.html"><strong>M140</strong>: Set Bed Temperature</a></li> <li><a href="/docs/gcode/M141.html"><strong>M141</strong>: Set Chamber Temperature</a></li> <li><a href="/docs/gcode/M143.html"><strong>M143</strong>: Set Laser Cooler Temperature</a></li> <li><a href="/docs/gcode/M145.html"><strong>M145</strong>: Set Material Preset</a></li> <li><a href="/docs/gcode/M149.html"><strong>M149</strong>: Set Temperature Units</a></li> <li><a href="/docs/gcode/M150.html"><strong>M150</strong>: Set RGB(W) Color</a></li> <li><a href="/docs/gcode/M154.html"><strong>M154</strong>: Position Auto-Report</a></li> <li><a href="/docs/gcode/M155.html"><strong>M155</strong>: Temperature Auto-Report</a></li> <li><a href="/docs/gcode/M163.html"><strong>M163</strong>: Set Mix Factor</a></li> <li><a href="/docs/gcode/M164.html"><strong>M164</strong>: Save Mix</a></li> <li><a href="/docs/gcode/M165.html"><strong>M165</strong>: Set Mix</a></li> <li><a href="/docs/gcode/M166.html"><strong>M166</strong>: Gradient Mix</a></li> <li><a href="/docs/gcode/M190.html"><strong>M190</strong>: Wait for Bed Temperature</a></li> <li><a href="/docs/gcode/M191.html"><strong>M191</strong>: Wait for Chamber Temperature</a></li> <li><a href="/docs/gcode/M192.html"><strong>M192</strong>: Wait for Probe temperature</a></li> <li><a href="/docs/gcode/M193.html"><strong>M193</strong>: Set Laser Cooler Temperature</a></li> <li><a href="/docs/gcode/M200.html"><strong>M200</strong>: Set Filament Diameter</a></li> <li><a href="/docs/gcode/M201.html"><strong>M201</strong>: Print / Travel Move Limits</a></li> <li><a href="/docs/gcode/M203.html"><strong>M203</strong>: Set Max Feedrate</a></li> <li><a href="/docs/gcode/M204.html"><strong>M204</strong>: Set Starting Acceleration</a></li> <li><a href="/docs/gcode/M205.html"><strong>M205</strong>: Set Advanced Settings</a></li> <li><a href="/docs/gcode/M206.html"><strong>M206</strong>: Set Home Offsets</a></li> <li><a href="/docs/gcode/M207.html"><strong>M207</strong>: Set Firmware Retraction</a></li> <li><a href="/docs/gcode/M208.html"><strong>M208</strong>: Firmware Recover</a></li> <li><a href="/docs/gcode/M209.html"><strong>M209</strong>: Set Auto Retract</a></li> <li><a href="/docs/gcode/M211.html"><strong>M211</strong>: Software Endstops</a></li> <li><a href="/docs/gcode/M217.html"><strong>M217</strong>: Filament swap parameters</a></li> <li><a href="/docs/gcode/M218.html"><strong>M218</strong>: Set Hotend Offset</a></li> <li><a href="/docs/gcode/M220.html"><strong>M220</strong>: Set Feedrate Percentage</a></li> <li><a href="/docs/gcode/M221.html"><strong>M221</strong>: Set Flow Percentage</a></li> <li><a href="/docs/gcode/M226.html"><strong>M226</strong>: Wait for Pin State</a></li> <li><a href="/docs/gcode/M240.html"><strong>M240</strong>: Trigger Camera</a></li> <li><a href="/docs/gcode/M250.html"><strong>M250</strong>: LCD Contrast</a></li> <li><a href="/docs/gcode/M255.html"><strong>M255</strong>: LCD Sleep/Backlight Timeout</a></li> <li><a href="/docs/gcode/M256.html"><strong>M256</strong>: LCD Brightness</a></li> <li><a href="/docs/gcode/M260.html"><strong>M260</strong>: I2C Send</a></li> <li><a href="/docs/gcode/M261.html"><strong>M261</strong>: I2C Request</a></li> <li><a href="/docs/gcode/M280.html"><strong>M280</strong>: Servo Position</a></li> <li><a href="/docs/gcode/M281.html"><strong>M281</strong>: Edit Servo Angles</a></li> <li><a href="/docs/gcode/M282.html"><strong>M282</strong>: Detach Servo</a></li> <li><a href="/docs/gcode/M290.html"><strong>M290</strong>: Babystep</a></li> <li><a href="/docs/gcode/M300.html"><strong>M300</strong>: Play Tone</a></li> <li><a href="/docs/gcode/M301.html"><strong>M301</strong>: Set Hotend PID</a></li> <li><a href="/docs/gcode/M302.html"><strong>M302</strong>: Cold Extrude</a></li> <li><a href="/docs/gcode/M303.html"><strong>M303</strong>: PID autotune</a></li> <li><a href="/docs/gcode/M304.html"><strong>M304</strong>: Set Bed PID</a></li> <li><a href="/docs/gcode/M305.html"><strong>M305</strong>: User Thermistor Parameters</a></li> <li><a href="/docs/gcode/M306.html"><strong>M306</strong>: Model Predictive Temp. Control</a></li> <li><a href="/docs/gcode/M350.html"><strong>M350</strong>: Set micro-stepping</a></li> <li><a href="/docs/gcode/M351.html"><strong>M351</strong>: Set Microstep Pins</a></li> <li><a href="/docs/gcode/M355.html"><strong>M355</strong>: Case Light Control</a></li> <li><a href="/docs/gcode/M360.html"><strong>M360</strong>: SCARA Theta A</a></li> <li><a href="/docs/gcode/M361.html"><strong>M361</strong>: SCARA Theta-B</a></li> <li><a href="/docs/gcode/M362.html"><strong>M362</strong>: SCARA Psi-A</a></li> <li><a href="/docs/gcode/M363.html"><strong>M363</strong>: SCARA Psi-B</a></li> <li><a href="/docs/gcode/M364.html"><strong>M364</strong>: SCARA Psi-C</a></li> <li><a href="/docs/gcode/M380.html"><strong>M380</strong>: Activate Solenoid</a></li> <li><a href="/docs/gcode/M381.html"><strong>M381</strong>: Deactivate Solenoids</a></li> <li><a href="/docs/gcode/M400.html"><strong>M400</strong>: Finish Moves</a></li> <li><a href="/docs/gcode/M401.html"><strong>M401</strong>: Deploy Probe</a></li> <li><a href="/docs/gcode/M402.html"><strong>M402</strong>: Stow Probe</a></li> <li><a href="/docs/gcode/M403.html"><strong>M403</strong>: MMU2 Filament Type</a></li> <li><a href="/docs/gcode/M404.html"><strong>M404</strong>: Set Filament Diameter</a></li> <li><a href="/docs/gcode/M405.html"><strong>M405</strong>: Filament Width Sensor On</a></li> <li><a href="/docs/gcode/M406.html"><strong>M406</strong>: Filament Width Sensor Off</a></li> <li><a href="/docs/gcode/M407.html"><strong>M407</strong>: Filament Width</a></li> <li><a href="/docs/gcode/M410.html"><strong>M410</strong>: Quickstop</a></li> <li><a href="/docs/gcode/M412.html"><strong>M412</strong>: Filament Runout</a></li> <li><a href="/docs/gcode/M413.html"><strong>M413</strong>: Power-loss Recovery</a></li> <li><a href="/docs/gcode/M420.html"><strong>M420</strong>: Bed Leveling State</a></li> <li><a href="/docs/gcode/M421.html"><strong>M421</strong>: Set Mesh Value</a></li> <li><a href="/docs/gcode/M422.html"><strong>M422</strong>: Set Z Motor XY</a></li> <li><a href="/docs/gcode/M423.html"><strong>M423</strong>: X Twist Compensation</a></li> <li><a href="/docs/gcode/M425.html"><strong>M425</strong>: Backlash compensation</a></li> <li><a href="/docs/gcode/M428.html"><strong>M428</strong>: Home Offsets Here</a></li> <li><a href="/docs/gcode/M430.html"><strong>M430</strong>: Power Monitor</a></li> <li><a href="/docs/gcode/M486.html"><strong>M486</strong>: Cancel Objects</a></li> <li><a href="/docs/gcode/M493.html"><strong>M493</strong>: Fixed-Time Motion</a></li> <li><a href="/docs/gcode/M500.html"><strong>M500</strong>: Save Settings</a></li> <li><a href="/docs/gcode/M501.html"><strong>M501</strong>: Restore Settings</a></li> <li><a href="/docs/gcode/M502.html"><strong>M502</strong>: Factory Reset</a></li> <li><a href="/docs/gcode/M503.html"><strong>M503</strong>: Report Settings</a></li> <li><a href="/docs/gcode/M504.html"><strong>M504</strong>: Validate EEPROM contents</a></li> <li><a href="/docs/gcode/M510.html"><strong>M510</strong>: Lock Machine</a></li> <li><a href="/docs/gcode/M511.html"><strong>M511</strong>: Unlock Machine</a></li> <li><a href="/docs/gcode/M512.html"><strong>M512</strong>: Set Passcode</a></li> <li><a href="/docs/gcode/M524.html"><strong>M524</strong>: Abort SD print</a></li> <li><a href="/docs/gcode/M540.html"><strong>M540</strong>: Endstops Abort SD</a></li> <li><a href="/docs/gcode/M569.html"><strong>M569</strong>: Set TMC stepping mode</a></li> <li><a href="/docs/gcode/M575.html"><strong>M575</strong>: Serial baud rate</a></li> <li><a href="/docs/gcode/M592.html"><strong>M592</strong>: Nonlinear Extrusion Control</a></li> <li><a href="/docs/gcode/M593.html"><strong>M593</strong>: ZV Input Shaping</a></li> <li><a href="/docs/gcode/M600.html"><strong>M600</strong>: Filament Change</a></li> <li><a href="/docs/gcode/M603.html"><strong>M603</strong>: Configure Filament Change</a></li> <li><a href="/docs/gcode/M605.html"><strong>M605</strong>: Multi Nozzle Mode</a></li> <li><a href="/docs/gcode/M665.html"><strong>M665</strong>: Delta Configuration</a></li> <li><a href="/docs/gcode/M665-scara.html"><strong>M665</strong>: SCARA Configuration</a></li> <li><a href="/docs/gcode/M666.html"><strong>M666</strong>: Set Delta endstop adjustments</a></li> <li><a href="/docs/gcode/M666-dual.html"><strong>M666</strong>: Set dual endstop offsets</a></li> <li><a href="/docs/gcode/M672.html"><strong>M672</strong>: Duet Smart Effector sensitivity</a></li> <li><a href="/docs/gcode/M701.html"><strong>M701</strong>: Load filament</a></li> <li><a href="/docs/gcode/M702.html"><strong>M702</strong>: Unload filament</a></li> <li><a href="/docs/gcode/M710.html"><strong>M710</strong>: Controller Fan settings</a></li> <li><a href="/docs/gcode/M808.html"><strong>M808</strong>: Repeat Marker</a></li> <li><a href="/docs/gcode/M810-M819.html"><strong>M810-M819</strong>: G-code macros</a></li> <li><a href="/docs/gcode/M851.html"><strong>M851</strong>: XYZ Probe Offset</a></li> <li><a href="/docs/gcode/M852.html"><strong>M852</strong>: Bed Skew Compensation</a></li> <li><a href="/docs/gcode/M860-M869.html"><strong>M860-M869</strong>: I2C Position Encoders</a></li> <li><a href="/docs/gcode/M871.html"><strong>M871</strong>: Probe temperature config</a></li> <li><a href="/docs/gcode/M876.html"><strong>M876</strong>: Handle Prompt Response</a></li> <li><a href="/docs/gcode/M900.html"><strong>M900</strong>: Linear Advance Factor</a></li> <li><a href="/docs/gcode/M906.html"><strong>M906</strong>: Stepper Motor Current</a></li> <li><a href="/docs/gcode/M907.html"><strong>M907</strong>: Set Motor Current</a></li> <li><a href="/docs/gcode/M908.html"><strong>M908</strong>: Set Trimpot Pins</a></li> <li><a href="/docs/gcode/M909.html"><strong>M909</strong>: DAC Print Values</a></li> <li><a href="/docs/gcode/M910.html"><strong>M910</strong>: Commit DAC to EEPROM</a></li> <li><a href="/docs/gcode/M911.html"><strong>M911</strong>: TMC OT Pre-Warn Condition</a></li> <li><a href="/docs/gcode/M912.html"><strong>M912</strong>: Clear TMC OT Pre-Warn</a></li> <li><a href="/docs/gcode/M913.html"><strong>M913</strong>: Set Hybrid Threshold Speed</a></li> <li><a href="/docs/gcode/M914.html"><strong>M914</strong>: TMC Bump Sensitivity</a></li> <li><a href="/docs/gcode/M915.html"><strong>M915</strong>: TMC Z axis calibration</a></li> <li><a href="/docs/gcode/M916.html"><strong>M916</strong>: L6474 Thermal Warning Test</a></li> <li><a href="/docs/gcode/M917.html"><strong>M917</strong>: L6474 Overcurrent Warning Test</a></li> <li><a href="/docs/gcode/M918.html"><strong>M918</strong>: L6474 Speed Warning Test</a></li> <li><a href="/docs/gcode/M919.html"><strong>M919</strong>: TMC Chopper Timing</a></li> <li><a href="/docs/gcode/M928.html"><strong>M928</strong>: Start SD Logging</a></li> <li><a href="/docs/gcode/M951.html"><strong>M951</strong>: Magnetic Parking Extruder</a></li> <li><a href="/docs/gcode/M993.html"><strong>M993</strong>: Back up flash settings to SD</a></li> <li><a href="/docs/gcode/M994.html"><strong>M994</strong>: Restore flash from SD</a></li> <li><a href="/docs/gcode/M995.html"><strong>M995</strong>: Touch Screen Calibration</a></li> <li><a href="/docs/gcode/M997.html"><strong>M997</strong>: Firmware update</a></li> <li><a href="/docs/gcode/M999.html"><strong>M999</strong>: STOP Restart</a></li> <li><a href="/docs/gcode/M7219.html"><strong>M7219</strong>: MAX7219 Control</a></li> <li><a href="/docs/gcode/T.html"><strong>T0-T7</strong>: Select or Report Tool</a></li> <li><a href="/docs/gcode/T-mmu2.html"><strong>T?-Tx</strong>: MMU2 Special Commands</a></li> </ul> </li> <li class="dropdown-submenu hardware"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Hardware</a> <ul class="dropdown-menu"> <li><a href="/meta/hardware/">All documents</a></li> <li class="divider"> <li><a href="/docs/hardware/boards.html">Boards</a></li> <li><a href="/docs/hardware/controllers.html">Controllers and displays</a></li> <li class="divider"> <li><a href="/docs/hardware/endstops.html">Endstops</a></li> <li><a href="/docs/hardware/tmc_drivers.html">Trinamic drivers</a></li> </ul> </li> <li class="dropdown-submenu setting"> <a href="#" class="dropdown-toggle" data-toggle="dropdown">Settings</a> <ul class="dropdown-menu"> <li><a href="/meta/setting/">All documents</a></li> <li class="divider"> <li><a href="/docs/setting/config_info.html">Configuration Info</a></li> <li><a href="/docs/setting/extruder.html">Extruders</a></li> <li><a href="/docs/setting/hardware.html">Hardware</a></li> <li><a href="/docs/setting/machine_info.html">Machine Info</a></li> <li><a href="/docs/setting/stepper_drivers.html">Stepper Drivers</a></li> <li><a href="/docs/setting/temperature.html">Temperature</a></li> </ul> </li> <li><a href="/docs/basics/troubleshooting.html">Troubleshooting</a></li> <li class="divider"> <li><a href="/meta/in-review/">Documentation Needing Review</a></li> </ul> </li> <li id="top-donate"><a href="/docs/development/contributing.html#donate">❤️ Donate</a></li> <li id="searchbox"> <form action="/meta/search/"> <input type="search" name="q" placeholder="Search"> </form> </li> </ul> <ul class="nav navbar-right hidden-sm"> <li> <a href="https://github.com/MarlinFirmware/MarlinDocumentation/edit/master/_features/lin_advance.md" data-proofer-ignore><i class="fa fa-pen-to-square" aria-hidden="true"></i> <span>Edit Page</span></a> </li> </ul> </div> </div> </nav> <div class="custom-btn"> <div class="row hidden-md hidden-lg hidden-xl"> <a class="btn btn-edit e-btn btn-block btn-lg" href="https://github.com/MarlinFirmware/MarlinDocumentation/edit/master/_features/lin_advance.md" data-proofer-ignore role="button"><span class="e-btn-text"><em class="fa fa-pen-to-square" aria-hidden="true"></em>  Edit Page</span></a> </div> <div class="row"> <a class="btn btn-learn e-btn btn-block btn-lg" href="/docs/basics/introduction.html" role="button"> <span class="e-btn-text"><em class="fa fa-book" aria-hidden="true"></em>  Learn more</span></a> </div> <div class="row"> <a class="btn btn-contribute e-btn btn-block btn-lg" href="/docs/development/contributing.html" role="button"> <span class="e-btn-text"><em class="fa fa-users" aria-hidden="true"></em>  Contribute</span></a> </div> <div class="row"> <a class="btn btn-download e-btn btn-block btn-lg" href="/meta/download/" role="button"> <span class="e-btn-text"><em class="fa fa-download" aria-hidden="true"></em>  Download</span></a> </div> <div class="row"> <a class="btn btn-follow e-btn btn-block btn-lg" href="//fosstodon.org/@marlinfirmware" role="button"> <span class="e-btn-text"><em class="fa-brands fa-mastodon" aria-hidden="true"></em>  Follow @MarlinFirmware</span></a> </div> <div class="row"> <a class="btn btn-follow e-btn btn-block btn-lg" href="//twitter.com/marlinfirmware" role="button"> <span class="e-btn-text"><em class="fa-brands fa-x" aria-hidden="true"></em>  Follow @MarlinFirmware</span></a> </div> </div> <div class="container" role="main"> <div class="row"> <div class="col-lg-3 col-md-4 visible-lg-block visible-md-block custom-no-padding"> <div class="custom-fixed-sidebar"> <div id="toc"></div> </div> </div> <div class="col-lg-9 col-md-8"> <div class="row"> <div class="col-md-12 custom-article"> <p id="authors" class="text-right pull-right visible-lg-block hidden-print small custom-pt25"> <a href="//github.com/Sebastianv650" data-toggle="tooltip" data-placement="bottom" title="Visit Sebastianv650's profile on Github"><img class="avatar avatar-small" alt="Sebastianv650" width="30" height="30" data-proofer-ignore="true" src="https://avatars1.githubusercontent.com/Sebastianv650?v=3&amp;s=30" srcset="https://avatars1.githubusercontent.com/Sebastianv650?v=3&amp;s=30 1x, https://avatars1.githubusercontent.com/Sebastianv650?v=3&amp;s=60 2x, https://avatars1.githubusercontent.com/Sebastianv650?v=3&amp;s=90 3x, https://avatars1.githubusercontent.com/Sebastianv650?v=3&amp;s=120 4x"></a> <a href="//github.com/Sineos" data-toggle="tooltip" data-placement="bottom" title="Visit Sineos's profile on Github"><img class="avatar avatar-small" alt="Sineos" width="30" height="30" data-proofer-ignore="true" src="https://avatars2.githubusercontent.com/Sineos?v=3&amp;s=30" srcset="https://avatars2.githubusercontent.com/Sineos?v=3&amp;s=30 1x, https://avatars2.githubusercontent.com/Sineos?v=3&amp;s=60 2x, https://avatars2.githubusercontent.com/Sineos?v=3&amp;s=90 3x, https://avatars2.githubusercontent.com/Sineos?v=3&amp;s=120 4x"></a> </p> <h1 class="custom-article-header">Linear Advance</h1> <p>Under default conditions, extruder axis movement is treated in the same way as the XYZ linear axes. The extruder motor moves in linear proportion to all the other motors, maintaining exactly the same acceleration profile and start/stop points. But an extruder is not a linear system, so this approach leads, most obviously, to extra material being extruded at the end of each linear movement.</p> <p>Take the common test-cube as an example. Even with the best tuning the corners aren’t usually sharp, but bleed out. The top solid infill displays roughness where the print direction changes on perimeters. Such problems are minor or even imperceptible at low printing speeds, but they become more noticeable and problematic as print speeds increase.</p> <p>Tuning flow and retraction can help, but this may lead to under-extrusion when starting new lines. Some slicers include an option to end extrusion early in each move, but this adds more complexity to the G-code and has to be re-tuned for different temperatures and materials.</p> <p>Since the root cause is pressure, <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> de-couples extrusion from the other axes to better control material pressure inside the nozzle, adapting to the printing speed. Once Linear Advance is properly tuned, bleeding edges and rough solid infill should be nearly eliminated.</p> <h1 id="advantages">Advantages</h1> <ul> <li>Better dimensional precision due to reduced bleeding edges.</li> <li>Higher printing speeds are possible without any loss of print quality - as long as your extruder can handle the needed speed changes.</li> <li>Visible and tangible print quality is increased even at lower printing speeds.</li> <li>No need for high acceleration and jerk values to get sharp edges.</li> </ul> <h1 id="special-notes-for-v15">Special notes for v1.5</h1> <h2 id="changelog">Changelog</h2> <ul> <li>K is now a meaningful value with the unit [mm of filament compression needed per 1mm/s extrusion speed] or [mm/mm/s].</li> <li>Load inside stepper ISR reduced as no calculations are needed there any more. Instead, the extruder runs at a fixed speed offset during pressure adjustment. Therefore this version runs faster.</li> <li>LIN_ADVANCE now respects hardware limitations set in Configuration.h, namely extruder jerk. If the pressure corrections require faster adjustments than allowed by extruder jerk limit, the acceleration for this print move is limited to a value which allows to use extruder jerk speed as the upper limit.</li> <li>The pressure adjustment moves don’t lead to a rattling extruder as it was in v1.0: as the extruder is now running at a smooth speed instead of jerking between multiples of extruder print speed.</li> <li>This smooth extruder operation and respecting of jerk limits ensures no extruder steps are skipped.</li> </ul> <h2 id="new-k-value-required">New K value required</h2> <p>As the unit of K has changed, you have to redo the K calibration procedure. See next chapter for details. While old v1 K values for PLA might be between 30-130, you can now expect K to be around 0.1-2.0.</p> <h2 id="lin_advance-may-reduce-acceleration">LIN_ADVANCE may reduce acceleration</h2> <p>In v1, if K was set to a high value which couldn’t be handled by your printer, then the printer was losing steps and/or using all of its processing power to execute extruder steps. In v1.5, this is handled much smarter. <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> will now check if it can execute the advance steps as needed. If the needed extruder speed exceeds the extruder jerk limit, it will reduce the print acceleration for the line printed to a value which keeps the extruder speed within the limit.</p> <p>While you will most likely not run into this on direct drive printers with filaments like PLA, it will happen most likely on Bowden printers as they need higher K values and therefore faster speed adaptions. If this happens to an amount you don’t want to accept, you have the following options:</p> <ul> <li>Check your extruder jerk setting. If you have the feeling it is set to a very conservative value, try increasing it.</li> <li>Keep the extruder acceleration low. This can be achieved by lowering the layer height or line width for example</li> <li>Keep K as low as possible. Maybe you can shorten the Bowden tube?</li> </ul> <h2 id="lin_advance-with-bowden-extruders">LIN_ADVANCE with Bowden extruders</h2> <p>A quite common note during development of <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> was that Bowden systems (and especially delta printers) are meant to be faster due to the lower moving mass. So lowering the print acceleration as described above would be an inadequate solution. On the other hand, Bowden systems need a pressure advance feature the most as they usually have the most problems with speed changes.</p> <p>Well, <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> was developed because I (Sebastianv650) wasn’t satisfied by the print quality I got out of my direct drive printer. While some might say that lowering acceleration on a Bowden printer (which is meant to be fast) is a bad thing, I see it differently: if you were satisfied with the print quality of your Bowden setup, you wouldn’t be reading about a way to do pressure corrections, right? So maybe in this case the highest possible top speed is quite useless. Bowdens are an option to keep moving mass low and therefore allowing higher movement speeds, but don’t expect them to give the same precise filament laydown ability than a direct drive one. It’s like painting a picture: try to paint with a 1m long brush, grabing the rear end of the handle which is made from rubber. Even if you try to compensate for the wobbly brush tip (which is basically what <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> does), it will never be as good as using a usual brush. On the other hand, if you only need to have a part printed fast without special needs in terms of quality, there is no reason to enable <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> at all. For those prints, you can just set K to 0.</p> <h1 id="calibration">Calibration</h1> <h2 id="generate-test-pattern">Generate Test Pattern</h2> <p>Marlin documentation provides a <a href="/tools/lin_advance/k-factor.html">K-Factor Calibration Pattern generator</a>. This script will generate a G-code file that supports determining a proper K-Factor value. The generated G-code will print a test pattern as shown in the following illustration:</p> <p><img src="/assets/images/features/lin_advance/k-factor_basics.png" alt="basics"></p> <p>Beginning with the chosen <code class="language-plaintext highlighter-rouge">Start value for K</code>, individual lines will be printed from left to right. Each line consists of 20mm extrusion using <code class="language-plaintext highlighter-rouge">Slow Printing Speed</code> being followed by 40mm of <code class="language-plaintext highlighter-rouge">Fast Printing Speed</code> and finally being concluded by another 20mm of <code class="language-plaintext highlighter-rouge">Slow Printing Speed</code>.</p> <p>For each new line the K-Factor will be increased by the <code class="language-plaintext highlighter-rouge">K-Factor Stepping</code> value, up to the provided <code class="language-plaintext highlighter-rouge">End Value for K</code>.</p> <p><br></p> <h3 id="general-considerations-for-the-test-pattern-settings">General considerations for the Test Pattern Settings</h3> <ul> <li> <a href="//reprap.org/wiki/Erik%27s_Bowden_Extruder">Bowden</a> extruders need a higher K-Factor than direct extruders. Consider a <code class="language-plaintext highlighter-rouge">Start value for K</code> of around 0.1 up to an <code class="language-plaintext highlighter-rouge">End Value for K</code> of around 2.0 for LIN_ADVANCE v1.5 or around 30 up to an <code class="language-plaintext highlighter-rouge">End Value for K</code> of around 130 for v1.0.</li> <li>The best matching K-Factor to be used in production depends on. <ul> <li>Type of filament. Extremely flexible filaments like Ninjaflex may not work at all.</li> <li>Printing temperature.</li> <li>Extruder characteristics: Bowden vs. direct extruder , Bowden length, free filament length in the extruder, etc.</li> <li>Nozzle size and geometry.</li> </ul> </li> <li>The extruder’s steps/mm value has to be <a href="//reprap.org/wiki/Triffid_Hunter%27s_Calibration_Guide#E_steps">calibrated precisely</a>. Calibration is recommended at low speeds to avoid additional influences.</li> <li>Minimize Backlash caused by gears <a href="//reprap.org/wiki/Wade%27s_Geared_Extruder">geared extruder</a> or by push fittings. As it will not influence the K-Factor, it can lead to strange noises from the extruder due to the pressure control.</li> </ul> <blockquote> <p>Repeat the calibration, if any of the above parameters change.</p> </blockquote> <p><br></p> <h2 id="evaluating-the-calibration-pattern">Evaluating the Calibration Pattern</h2> <p>The transition between <code class="language-plaintext highlighter-rouge">Slow Printing Speed</code> phases and <code class="language-plaintext highlighter-rouge">Fast Printing Speed</code> phases are the points of interest to determine the best matching K-Factor. Following illustration shows a magnified view of a line where the K-Factor is too low:</p> <p><img src="/assets/images/features/lin_advance/k-factor_low.png" alt="low"></p> <table> <thead> <tr> <th style="text-align: center">Phase</th> <th>Description</th> </tr> </thead> <tbody> <tr> <td style="text-align: center">1</td> <td><code class="language-plaintext highlighter-rouge">Slow Printing Speed</code></td> </tr> <tr> <td style="text-align: center">2</td> <td>Beginning of the <code class="language-plaintext highlighter-rouge">Fast Printing Speed</code>. The pressure build up in the nozzle (= amount of extruded material) is lagging behind the acceleration of the print-head. This results in too little material and a starved line. Towards the end of this phase, the pressure is catching up to its intended value.</td> </tr> <tr> <td style="text-align: center">3</td> <td>Extrusion and print-head movement are in sync. The nominal line width is extruded</td> </tr> <tr> <td style="text-align: center">4</td> <td>Beginning of the deceleration towards <code class="language-plaintext highlighter-rouge">Slow Printing Speed</code>. Here the opposite of Phase 2 can be observed: The pressure decrease in the nozzle is lagging behind the deceleration of the print-head. This results in too much material being extruded</td> </tr> <tr> <td style="text-align: center">5</td> <td>Beginning of the <code class="language-plaintext highlighter-rouge">Slow Printing Speed</code> phase. Still the pressure in the nozzle is not in sync with the intended extrusion amount and the line is suffering from over-extrusion.</td> </tr> <tr> <td style="text-align: center">6</td> <td> <code class="language-plaintext highlighter-rouge">Slow Printing Speed</code> has stabilized.</td> </tr> </tbody> </table> <p>A too high K-Factor essentially reverses the above picture. The extruded amount will overshoot at the start of an acceleration and starve in the deceleration phase. <br></p> <blockquote> <p>The test line, which has a fluid and barely visible or even invisible transition between the different speed phases represents the best matching K-Factor.</p> </blockquote> <p><br></p> <h1 id="setting-the-k-factor-for-production">Setting the K-Factor for production</h1> <h2 id="considerations-before-using-linear-advance">Considerations before using Linear Advance</h2> <ul> <li>Some slicers have options to control the nozzle pressure. Common names are: <em>Pressure advance</em>, <em>Coast at end</em>, <em>extra restart length after retract</em>. Disable these options as they will interfere with Linear Advance.</li> <li>Also disable options like <em>wipe while retract</em> or <em>combing</em>. There should be almost no ooze, once the proper K-Factor is found.</li> <li>Recheck retraction distance, once Linear Advance is calibrated and working well. It may even be as low as 0, since pressure control reduces the material pressure at the end of a line to nearly zero.</li> </ul> <h2 id="the-following-considerations-are-no-longer-a-problem-with-lin_advance-version-15">The following considerations are no longer a problem with LIN_ADVANCE version 1.5</h2> <ul> <li>This feature adds extra load to the CPU (and possibly more wear on the extruder). Using a communication speed of 115200 baud or lower to prevent communication errors and “weird” movements is recommended.</li> <li>The print host software should be using line numbers and checksums. (This is disabled by default e.g. in Simplify3D)</li> <li>Theoretically there should be no “extra” movements produced by <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code>. If extra movements were produced, this would tend to increase wear on more fragile parts such as the printed gears of a Wade extruder.</li> </ul> <h2 id="saving-the-k-factor-in-the-firmware">Saving the K-Factor in the Firmware</h2> <p>If only one filament material is used, the best way is to set the K-Factor inside <code class="language-plaintext highlighter-rouge">Configuration_adv.h</code> and reflash the firmware:</p> <div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>/**
* Implementation of linear pressure control
*
* Assumption: advance = k * (delta velocity)
* K=0 means advance disabled.
* See Marlin documentation for calibration instructions.
*/
#define LIN_ADVANCE

#if ENABLED(LIN_ADVANCE)
#define LIN_ADVANCE_K &lt;your_value_here&gt;
</code></pre></div></div> <h2 id="adding-the-k-factor-to-the-g-code-start-script">Adding the K-Factor to the G-code Start Script</h2> <p><a href="//reprap.org/wiki/Start_GCode_routines">G-code Start Scripts</a> are supported by various slicers. The big advantage of setting the K-Factor via this methods is that it can easily be modified, e.g. when switching to a different material. The K-Factor is defined by adding the command <code class="language-plaintext highlighter-rouge">M900 Kxx</code> to the end of the start script, where <em>xx</em> is the value determined with the above test pattern.</p> <p>The following chapter briefly describes where to find the relevant setting in popular slicers.</p> <p><strong>Note 1:</strong></p> <p>With the G-code Start Script method, the feature still needs to be activated in the firmware as described in <a href="#saving-the-k-factor-in-the-firmware">Saving the K-Factor in the Firmware</a>. It is recommended to set <code class="language-plaintext highlighter-rouge">#define LIN_ADVANCE_K</code> to 0, which effectively disables the hard-coded firmware value. In this case only the K-Factor set via the start script is used.</p> <p><strong>Note 2:</strong></p> <p>The shown G-code Start Scripts are individual to each printer and personal taste. This is only intended to demonstrate where the K-Factor setting can be applied.</p> <p><br></p> <h3 id="cura">Cura</h3> <p><em>Settings</em> —&gt; <em>Printer</em> —&gt; <em>Manage Printer</em> —&gt; <em>Machine Settings</em></p> <p><img src="/assets/images/features/lin_advance/cura.png" alt="cura"> <br><br><br></p> <h3 id="slic3r">Slic3r</h3> <p><em>Settings</em> —&gt; <em>Printer Settings</em> —&gt; <em>Custom G-code</em></p> <p><img src="/assets/images/features/lin_advance/slic3r.png" alt="slic3r"> <br><br><br></p> <h3 id="simplify-3d">Simplify 3D</h3> <p><em>Edit Process Settings</em> —&gt; <em>Show Advanced</em> –&gt; <em>Scripts</em> —&gt; <em>Custom G-code</em></p> <p><img src="/assets/images/features/lin_advance/s3d.png" alt="s3d"> <br><br></p> <h1 id="developer-information">Developer Information</h1> <h2 id="general-informations">General Informations</h2> <p>The force required to push the filament through the nozzle aperture depends, in part, on the speed at which the material is being pushed into the nozzle. If the material is pushed faster (=printing fast), the filament needs to be compressed more before the pressure inside the nozzle is high enough to start extruding the material.</p> <p>For a single, fast printed line, this results in under-extrusion at the line’s starting point (the filament gets compressed, but the pressure isn’t high enough) and over-extrusion with a blob at the end of the line (the filament is still compressed when the E motor stops, resulting in oozing).</p> <p>For a complete print, this leads to bleeding edges at corners (corners are stop/end points of lines) and in extreme cases even gaps between perimeters due to under-extrusion at their starting points.</p> <h2 id="version-15">Version 1.5</h2> <p>Version 1.5 handles the pressure correction in a slightly different way to reach the following goals:</p> <ul> <li>respect extruder jerk</li> <li>ensure a smooth extruder movement without rattling</li> <li>reduce load inside stepper ISR</li> </ul> <p>It does this by calculating an extruder speed offset within the planner for the given segment. If we have a true, linear acceleration then this will execute the needed advance steps just in time, so we have reached all our needed advance steps just when the acceleration part is over. As Marlin uses an approximation for the acceleration calculation inside the ISR, this is not perfectly true, we will come to this later. If the needed speed offset exceeds the allowed extruder jerk, the print acceleration for this segment is reduced to a lower value so extruder jerk is not exceeded any more. This is comparable to the check Marlin does for each axis, for example if we have a print acceleration of 2000mm/s² but X axis max. acceleration is set to 500mm/s², print acceleration is reduced to 500mm/s². During the trapezoid calculation, <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> calculates the needed amount of advance steps at cruising speed and at final speed (=speed at and of the block).</p> <p>When this block is executed by the stepper ISR, the extruder is set to a frequency which represents the calculated speed offset. The advance step is executed together with normal e steps. During the block runtime, the pressure will be advanced until the precalculated needed extra step amount is reached or the deceleration is started. During deceleration we reduce the advance step amount until we reach the amount for final speed or the block comes to an end. This checks are necessary as Marlin uses an approximation for acceleration calculation as mentioned above. Therefore, for example, we might not reach the final pressure at end of move perfectly but that’s not important as this error will not cumulate.</p> <p>The next update might include improved handling of variable width moves. On variable width path it’s possible that we need to deplete pressure during acceleration, for example when the next line is much narrower than the previous one. Therefore <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> would need to check for the actual extruder direction needed. Another case to be considered is the gap fill to the tip of a triangle: in this case Marlin will move on with a constant speed, but the extruder speed and therefore needed pressure gets smaller and smaller when we approach the tip of the triangle. We should adapt nozzle pressure with max. possible speed (extruder jerk speed) then. As gap fill is done at quite low speeds by most slicers, we have to decide if that extra load is worth the effect. On 32bit boards where calculation performance is most likely not a problem, it makes sense in any case.</p> <h2 id="version-10">Version 1.0</h2> <p>The <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> pressure control handles this free filament length as a spring, where <code class="language-plaintext highlighter-rouge">K</code> is a spring constant. When the nozzle starts to print a line, it takes the extrusion speed as a reference. Additional to the needed extrusion length for a line segment, which is defined by the slicer, it calculates the needed extra compression of the filament to reach the needed nozzle pressure so that the extrusion length defined by the slicer is really extruded. This is done in every loop of the stepper ISR.</p> <p>During deceleration, the filament compression is released again by the same formula: <code class="language-plaintext highlighter-rouge">advance_steps = delta_extrusion_speed * K</code>. During deceleration, <code class="language-plaintext highlighter-rouge">delta_extrusion_speed</code> is negative, thus the <code class="language-plaintext highlighter-rouge">advance_steps</code> values is negative which leads to a <strong>retract</strong> (or slowed) movement, relaxing the filament again.</p> <p>The basic formula (<code class="language-plaintext highlighter-rouge">advance_steps = delta_extrusion_speed * K</code>) is the same as in the famous JKN pressure control, but with one important difference: JKN calculates the sum of all required advance extruder steps inside the planner loop and distributes them equally over every acceleration and deceleration stepper ISR loop. This leads to the wrong distribution of advance steps, resulting in an imperfect print result. <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> calculates the extra steps on the fly in <em>every</em> stepper ISR loop, therefore applying the required steps precisely where needed.</p> <p>For further details and graphs have a look into <a href="//drive.google.com/file/d/0B5UvosQgK3adaHVtdUI5OFR3VUU/view">this presentation, slides 7-9</a>.</p> <p>In Marlin, all the work is done in the <code class="language-plaintext highlighter-rouge">stepper.*</code> and <code class="language-plaintext highlighter-rouge">planner.*</code> files. In the planner loop, <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> checks whether a move needs pressure control. This applies only to print moves, not to travel moves and extruder-only moves (like retract and prime).</p> <p>In the <code class="language-plaintext highlighter-rouge">Stepper::isr</code> method, <code class="language-plaintext highlighter-rouge">LIN_ADVANCE</code> calculates the number of extra steps needed to reach the required nozzle pressure. To avoid missing steps, it doesn’t execute them all at once, but distributes them over future calls to the interrupt service routine.</p> <p>In v1.0 there is no check if the extruder acceleration, speed or jerk will exceed the limits set inside Configuration.h!</p> </div> </div> </div> </div> </div> <footer> <div class="container shift-footer "> <div class="row"> <div class="col-8"> <p>Brought to you with <i class="fa fa-heart text-danger" aria-hidden="true"></i> lack of <i class="fa fa-bed" aria-hidden="true"></i> and lots of <i class="fa fa-coffee" aria-hidden="true"></i>. <br> The contents of this website are © 2024 under the terms of the <a href="//www.gnu.org/licenses/gpl-3.0.txt">GPLv3</a> License.</p> </div> <div class="col-4"> <div class="pull-right back-to-top"> <a href="#top" data-proofer-ignore> Back to top <i class="fa fa-level-up" aria-hidden="true"></i></a> </div> </div> </div> </div> </footer> <script>
      (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
      })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

      ga('create', 'UA-76230130-1', {
          'cookieDomain': 'marlinfw.org',
          'siteSpeedSampleRate': 80
      });

      ga('require', 'displayfeatures');
      ga('send', 'pageview');
    </script> </body> </html>